<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TikTok Tasks</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root{
  --green:#34d399;
  --red:#ef4444;
  --gray:#e5e7eb;
  --blue:#3b82f6;
  --text-light:#111827;
  --text-dark:#e5e7eb;
  --text-dim:#78350f; /* warm yellow-brown text for eye care */
}

/* Font & body */
body{
  font-family:system-ui,-apple-system,BlinkMacSystemFont;
  transition: background .3s,color .3s;
}

/* Themes */
body.light{background:linear-gradient(180deg,#f9fafb,#f3f4f6);color:var(--text-light);}
body.dark{background:#0f172a;color:var(--text-dark);}
body.dim{background:#fef3c7;color:var(--text-dim);} /* warm eye-care yellow background */

/* Cards */
.card{
  background:white;
  border-radius:16px;
  padding:14px;
  margin-bottom:12px;
  box-shadow:0 6px 14px rgba(0,0,0,.08);
  transition:all .25s ease;
}
body.dark .card{background:#1e293b;}
body.dim .card{background:#fcd34d;} /* warm yellow for cards */

/* Hover / tap feedback */
.card.clickable:hover{
  transform:translateY(-2px) scale(1.01);
  box-shadow:0 10px 22px rgba(0,0,0,.12);
}
.card.clickable:active{
  transform:scale(.97);
}

/* States */
.done{background:var(--green)!important;color:white;animation:pop .3s ease;}
.failed{background:var(--red)!important;color:white;}
.disabled{opacity:.45;pointer-events:none;}

/* Time rows */
.time-row{
  background:var(--gray);
  border-radius:14px;
  padding:14px;
  margin-bottom:8px;
  cursor:pointer;
  transition:all .25s ease;
  display:flex; justify-content:space-between; align-items:center;
}
body.dark .time-row{background:#334155;}
body.dim .time-row{background:#fde68a;} /* soft yellow for eye care */
.time-row:hover{transform:scale(1.02);}
.time-row.done{background:var(--green);color:white;pointer-events:none;animation:pop .25s ease;}
.time-row.next{background:var(--blue);color:white;animation:pulse 1.5s infinite;}

/* Animations */
@keyframes pop{0%{transform:scale(.95)}100%{transform:scale(1)}}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(59,130,246,.5)}70%{box-shadow:0 0 0 14px rgba(59,130,246,0)}100%{box-shadow:0 0 0 0 rgba(59,130,246,0)}}

/* Header */
#header{
  position:sticky;
  top:0;
  z-index:10;
  padding-bottom:6px;
  display:flex; justify-content:space-between; align-items:center;
}

/* Back button */
#backBtn{
  cursor:pointer; font-size:2rem; margin-bottom:12px; user-select:none;
}

/* Responsive */
@media (min-width:768px){.container{max-width:640px}}
@media (min-width:1024px){.container{max-width:720px}}
</style>
</head>

<body class="light">
<div class="container mx-auto p-4">

  <!-- HEADER (main page only) -->
  <div id="header">
    <div class="text-lg font-bold tracking-wide"></div>
    <div class="flex gap-2" id="headerButtons">
      <button id="themeBtn" class="px-3 py-1 rounded-full bg-gray-200 dark:bg-slate-700">‚òÄÔ∏è</button>
      <button id="resetBtn" class="px-3 py-1 rounded-full bg-gray-200 dark:bg-slate-700">‚Ü∫</button>
    </div>
  </div>

  <!-- BACK BUTTON -->
  <div id="backBtn" class="hidden">‚Üê</div>

  <!-- Pages -->
  <div id="datesPage"></div>
  <div id="accountsPage" class="hidden"></div>
  <div id="timesPage" class="hidden"></div>

</div>

<script>
// ========== CONFIG ==========
const today = new Date().toISOString().split("T")[0];
const nowMinutes = new Date().getHours()*60 + new Date().getMinutes();

const accountsData=[
  {name:"Priya", topic:"Candy_0999 (Insta)", times:["15:45","19:45","22:45"]},
  {name:"Muskan Khan", topic:"Random Edit Clips", times:["16:00","20:00","22:30"]},
  {name:"Maya Ali", topic:"Random Edit Clips", times:["16:15","20:15","22:45"]},
  {name:"Sarah Khan", topic:"Sanrita Videos Edit", times:["16:30","20:30","23:00"]},
  {name:"Dur-e-Fishan", topic:"Random Edit Clips", times:["16:45","20:45","23:15"]},
  {name:"Aisha", topic:"Prapit (Insta)", times:["17:00","21:00","23:30"]},
  {name:"Aalina Batool", topic:"Sanorita Videos Edit", times:["17:15","21:15","23:45"]}
];
const accountNames=accountsData.map(a=>a.name);

// ========== STORAGE ==========
let store=JSON.parse(localStorage.getItem("automation"))||{};
const save=()=>localStorage.setItem("automation",JSON.stringify(store));

// ========== ELEMENTS ==========
const datesPage=document.getElementById("datesPage");
const accountsPage=document.getElementById("accountsPage");
const timesPage=document.getElementById("timesPage");
const backBtn=document.getElementById("backBtn");
const resetBtn=document.getElementById("resetBtn");
const themeBtn=document.getElementById("themeBtn");
const headerButtons=document.getElementById("headerButtons");

let currentDate="";
let currentTheme=localStorage.getItem("theme")||"light";
document.body.className=currentTheme;

// ========== THEME ==========
const themeIcons={light:"‚òÄÔ∏è",dark:"üåë",dim:"‚õÖ"};
themeBtn.textContent=themeIcons[currentTheme];
themeBtn.onclick=()=>{
  const themes=["light","dark","dim"];
  let idx=(themes.indexOf(currentTheme)+1)%3;
  currentTheme=themes[idx];
  document.body.className=currentTheme;
  themeBtn.textContent=themeIcons[currentTheme];
  localStorage.setItem("theme",currentTheme);
};

// ========== RESET ==========
resetBtn.onclick=()=>{
  const date=prompt("Enter date (YYYY-MM-DD)");
  if(!date) return;
  if(prompt("Password")!=="mopi") return alert("Wrong password");
  delete store[date];
  save();
  renderDates();
};

// ========== RENDER DATES ==========
function renderDates(){
  headerButtons.classList.remove("hidden"); // show header buttons only on main page
  backBtn.classList.add("hidden");

  datesPage.innerHTML="";
  datesPage.classList.remove("hidden");
  accountsPage.classList.add("hidden");
  timesPage.classList.add("hidden");

  for(let i=0;i<60;i++){
    let d=new Date();
    d.setDate(d.getDate()+i);
    let dateStr=d.toISOString().split("T")[0];

    store[dateStr] ||= {};
    const data=store[dateStr];
    const allDone=accountNames.every(a=>data[a]?.done);
    const isPast=dateStr<today;

    let div=document.createElement("div");
    div.className="card text-center";
    div.innerText=dateStr;

    if(allDone) div.classList.add("done"),div.innerText+="\nAll tasks done";
    else if(isPast && Object.keys(data).length>0) div.classList.add("failed"),div.innerText+="\nTasks incomplete";

    if(dateStr===today || (isPast && Object.keys(data).length>0 && !allDone)){
      div.classList.add("clickable");
      div.onclick=()=>renderAccounts(dateStr);
    }else div.classList.add("disabled");

    datesPage.appendChild(div);
  }
}

// ========== RENDER ACCOUNTS ==========
function renderAccounts(date){
  currentDate=date;
  headerButtons.classList.add("hidden"); // hide header buttons on other pages
  header.classList.remove("hidden");
  backBtn.classList.remove("hidden");
  backBtn.onclick=renderDates;

  datesPage.classList.add("hidden");
  accountsPage.classList.remove("hidden");
  timesPage.classList.add("hidden");
  accountsPage.innerHTML="";

  store[date] ||= {};
  accountsData.forEach(acc=>{
    let div=document.createElement("div");
    div.className="card clickable";
    div.innerText=acc.name;

    if(store[date][acc.name]?.done) div.classList.add("done","disabled");
    else if(date<today) div.classList.add("failed","disabled");
    else div.onclick=()=>renderTimes(acc);

    accountsPage.appendChild(div);
  });
}

// ========== RENDER TIMES ==========
function renderTimes(acc){
  backBtn.onclick=()=>renderAccounts(currentDate);
  accountsPage.classList.add("hidden");
  timesPage.classList.remove("hidden");
  timesPage.innerHTML="";

  store[currentDate][acc.name] ||= {topic:acc.topic,times:acc.times,status:Array(acc.times.length).fill(false),done:false};
  const data=store[currentDate][acc.name];

  timesPage.innerHTML=`<div class="card text-center font-semibold">
    ${acc.name}<br><span class="text-sm opacity-70">${data.topic}</span></div>`;

  // Next upcoming
  let nextIndex=-1;
  if(currentDate===today){
    data.times.forEach((t,i)=>{
      const [h,m]=t.split(":").map(Number);
      if(nextIndex===-1 && h*60+m>nowMinutes && !data.status[i]) nextIndex=i;
    });
  }

  data.times.forEach((t,i)=>{
    let row=document.createElement("div");
    row.className="time-row";

    // Show original and hover 12h next to it
    const spanOriginal=document.createElement("span");
    spanOriginal.innerText=`Time: ${t}`;
    const spanHover=document.createElement("span");
    spanHover.className="opacity-70 text-sm";
    spanHover.style.marginLeft="8px";
    row.appendChild(spanOriginal);
    row.appendChild(spanHover);

    if(data.status[i]) row.classList.add("done");
    else if(i===nextIndex) row.classList.add("next");

    row.addEventListener("mouseenter",()=>{
      const [h,m]=t.split(":").map(Number);
      const hour=h%12||12;
      const ampm=h<12?"AM":"PM";
      spanHover.innerText=`(${hour}:${m.toString().padStart(2,"0")} ${ampm})`;
    });
    row.addEventListener("mouseleave",()=>{spanHover.innerText="";});

    row.onclick=()=>{
      if(data.status[i]) return;
      data.status[i]=true;
      if(data.status.every(v=>v)) data.done=true;
      save();
      renderTimes(acc);
    };
    timesPage.appendChild(row);
  });
}

// ========== INIT ==========
renderDates();
</script>
</body>
</html>
